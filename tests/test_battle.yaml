---
- config:
  - testset: "Battle"
  - timeout: 10
- test:
  - group: "Battle"
  - name: "Check if there is no battle with id 1"
  - url: "/battles/1"
  - expected_status: [404]
- test:
  - group: "Battle"
  - name: "Basic get"
  - url: "/battles/"
- test:
  - group: "Battle"
  - name: "Check if user 'creator' exists"
  - url: "/users/creator"
- test:
  - group: "Battle"
  - name: "Create new battle"
  - url: "/battles/"
  - method: "POST"
  - body: '{"name": "Nice battle", "latitude": "13", "longitude": "37", "creator": "creator", "radius": "100", "description": "yes"}'
  - headers: {'Content-Type': 'application/json'}
  - expected_status: [201]
- test:
  - group: "Battle"
  - name: "Get single battle"
  - url: "/battles/1"
  - validate: {jsonpath_mini: 'name', expected: 'Nice battle'}
- test:
  - group: "Battle"
  - name: "Get entries of battle with id 1"
  - url: "/battles/1/entries"
- test:
  - group: "Battle"
  - name: "Change created battle"
  - url: "/battles/1"
  - method: "PUT"
  - body: '{"name": "Very nice battle"}'
  - headers: {'Content-Type': 'application/json'}
- test:
  - group: "Battle"
  - name: "Add entry 1"
  - url: "/entries/"
  - method: "POST"
  - body: '{"latitude": "13", "longitude": "37", "user_id": "2", "battle_id": "1"}'
  - headers: {'Content-Type': 'application/json'}
  - expected_status: [201]
- test:
  - group: "Battle"
  - name: "Add entry 2"
  - url: "/entries/"
  - method: "POST"
  - body: '{"latitude": "13", "longitude": "37", "user_id": "3", "battle_id": "1"}'
  - headers: {'Content-Type': 'application/json'}
  - expected_status: [201]
- test:
  - group: "Battle"
  - name: "Get voting"
  - url: "/battles/1/voting"
  - method: "GET"
  - headers: {'Content-Type': 'application/json'}
- test:
  - group: "Battle"
  - name: "Vote for entry 1 (vs entry 2)"
  - url: "/battles/1/voting"
  - method: "POST"
  - body: '{"voter_id": 1, "winner_id": 1, "loser_id": 2}'
  - headers: {'Content-Type': 'application/json'}
  - expected_status: [201]
- test:
  - group: "Battle"
  - name: "Delete created battle"
  - url: "/battles/1"
  - method: "DELETE"
  - headers: {'Content-Type': 'application/json'}
- test:
  - group: "Battle"
  - name: "Make sure it was deleted"
  - url: "/battles/1"
  - expected_status: [404]
  - headers: {'Content-Type': 'application/json'}