---
- config:
  - testset: "User"
  - timeout: 10
- test:
  - group: "User"
  - name: "Check if there is no named ethan"
  - url: "/users/ethan"
  - expected_status: [404]
- test:
  - group: "User"
  - name: "Basic get"
  - url: "/users/"
- test:
  - group: "User"
  - name: "Create new user"
  - url: "/users/"
  - method: "POST"
  - body: '{"username": "ethan", "email": "h3@h3.com", "password": "vapenation"}'
  - headers: {'Content-Type': 'application/json'}
  - expected_status: [201]
- test:
  - group: "User"
  - name: "Get single user by username"
  - url: "/users/ethan"
- test:
  - group: "User"
  - name: "Get single user by id"
  - url: "/users/1"
  - validate: {jsonpath_mini: 'username', expected: 'ethan'}
- test:
  - group: "User"
  - name: "Change created user by id"
  - url: "/users/1"
  - method: "PUT"
  - body: '{"password": "Yall"}'
  - headers: {'Content-Type': 'application/json'}
- test:
  - group: "User"
  - name: "Change created user by username"
  - url: "/users/ethan"
  - method: "PUT"
  - body: '{"email": "h3h3@vapenation.org"}'
  - headers: {'Content-Type': 'application/json'}
  - validate: {jsonpath_mini: 'email', expected: 'h3h3@vapenation.org'}
- test:
  - group: "User"
  - name: "Create user with username starting with number (invalid)"
  - url: "/users/"
  - method: "POST"
  - body: '{"username": "101", "email": "one@one.one", "password": "one"}'
  - headers: {'Content-Type': 'application/json'}
  - expected_status: [422]
- test:
  - group: "User"
  - name: "Delete created user"
  - url: "/users/ethan"
  - method: "DELETE"
  - headers: {'Content-Type': 'application/json'}
- test:
  - group: "User"
  - name: "Make sure it was deleted"
  - url: "/users/ethan"
  - expected_status: [404]
  - headers: {'Content-Type': 'application/json'}